<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>getimagesize</title>
    <script>
        // var img_url = 'ning.jpg';

        // // 创建对象
        // var img = new Image();

        // // 改变图片的src
        // img.src = img_url;

        // // 判断是否有缓存
        // if (img.complete) {
        //     // 打印
        //     alert('from:complete : width:' + img.width + ',height:' + img.height);
        // } else {
        //     // 加载完成执行
        //     img.onload = function() {
        //         // 打印
        //         alert('from:onload : width:' + img.width + ',height:' + img.height);
        //     };
        // }
        // 记录当前时间戳
        var start_time = new Date().getTime();

        // 图片地址
        var img_url = 'ning.jpg?' + start_time;

        // 创建对象
        var img = new Image();

        // 改变图片的src
        img.src = img_url;

        // 定时执行获取宽高
        var check = function() {
            // 只要任何一方大于0
            // 表示已经服务器已经返回宽高
            if (img.width > 0 || img.height > 0) {
                var diff = new Date().getTime() - start_time;
                document.body.innerHTML += '<div>from:<span style="color:red;">check</span> : width:' + img.width + ',height:' + img.height + ', time:' + diff + 'ms</div>';
                clearInterval(set);
            }
        };

        var set = setInterval(check, 40);

        // 加载完成获取宽高
        img.onload = function() {
            var diff = new Date().getTime() - start_time;
            document.body.innerHTML += '<div>from:<span style="color:blue">onload</span> : width:' + img.width + ',height:' + img.height + ', time:' + diff + 'ms</div>';
        };
    </script>
</head>

<body>

</body>

</html>